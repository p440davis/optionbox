{"version":3,"file":"optionbox.js","sources":["../src/ts/_get.ts","../src/ts/_create.ts","../src/ts/_update.ts","../src/ts/optionbox.ts"],"sourcesContent":["const get = {\n\tdefaultConfig: {\n\t\tpersist: window.location.pathname,\n\t\tprefix: 'optionbox-',\n\t\tselect: 'select:not([multiple])'\n\t},\n\n\tconfig(userConfig) {\n\t\tlet config = (<any>Object).assign(this.defaultConfig, userConfig);\n\n\t\tif (!this.storageExists()) {\n\t\t\tconfig.persist = false;\n\t\t}\n\n\t\treturn config;\n\t},\n\n\tstorageExists() {\n\t\tif (typeof Storage !== undefined) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t},\n\n\tselectElements(selector) {\n\t\tlet elements = document.querySelectorAll(selector);\n\t\tlet selects = [];\n\n\t\tif (elements.length) {\n\t\t\t[].forEach.call(elements, element => {\n\t\t\t\tif (element.tagName === 'SELECT') {\n\t\t\t\t\tselects.push(element);\n\t\t\t\t} else\n\t\t\t\t\tconsole.warn(\n\t\t\t\t\t\t'Optionbox warning: Your selection includes a <' +\n\t\t\t\t\t\telement.tagName.toLowerCase() +\n\t\t\t\t\t\t'>. Only <select> elements can be converted to an optionbox'\n\t\t\t\t\t);\n\t\t\t});\n\t\t}\n\n\t\treturn selects;\n\t}\n};\n\nexport { get };\n","const create = {\r\n\toptionboxes(config, selectElements) {\r\n\t\tlet optionboxElements = [];\r\n\r\n\t\tselectElements.forEach(select => {\r\n\t\t\tlet prefix = config.prefix;\r\n\t\t\tlet name = select.name;\r\n\t\t\tlet classes = select.getAttribute('class');\r\n\t\t\tlet styles = select.getAttribute('style');\r\n\t\t\tlet storedValue = '';\r\n\t\t\tlet optgroupElements = select.querySelectorAll('optgroup');\r\n\t\t\tlet optionElements = select.querySelectorAll('option');\r\n\t\t\tlet optionbox = document.createElement('span');\r\n\t\t\tlet content = `<div class=${prefix}container>`;\r\n\r\n\t\t\tif (config.persist) {\r\n\t\t\t\tstoredValue = sessionStorage[config.persist + '>' + select.name];\r\n\t\t\t}\r\n\r\n\t\t\toptionbox.id = prefix + name;\r\n\t\t\tclasses != null && optionbox.setAttribute('class', classes);\r\n\t\t\toptionbox.classList.add(prefix);\r\n\t\t\tstyles != null && optionbox.setAttribute('style', styles);\r\n\r\n\r\n\t\t\tif (optgroupElements.length) {\r\n\t\t\t\tcontent += this.optgroups(optgroupElements, name, storedValue, prefix);\r\n\t\t\t} else {\r\n\t\t\t\tcontent += this.options(optionElements, name, storedValue, prefix);\r\n\t\t\t}\r\n\r\n\t\t\tcontent += '</div>';\r\n\r\n\t\t\toptionbox.innerHTML = content;\r\n\r\n\t\t\tselect.insertAdjacentElement('beforebegin', optionbox);\r\n\r\n\t\t\tselect.selectedIndex = -1;\r\n\t\t\tselect.remove();\r\n\r\n\t\t\toptionboxElements.push(optionbox);\r\n\t\t});\r\n\r\n\t\treturn (optionboxElements);\r\n\t},\r\n\r\n\toptgroups(optgroupElements, name, storedValue, prefix) {\r\n\t\tlet content = '';\r\n\r\n\t\t[].forEach.call(optgroupElements, optgroup => {\r\n\t\t\tlet label = optgroup.getAttribute('label');\r\n\t\t\tlet classes = optgroup.getAttribute('class');\r\n\t\t\tlet styles = optgroup.getAttribute('style');\r\n\t\t\tlet optionElements = optgroup.querySelectorAll('option');\r\n\r\n\t\t\tcontent += `<div \r\n                class=\"${prefix}group ${classes != null ? classes : ''}\"\r\n                style=\"${styles != null ? styles : ''}\">`;\r\n\r\n\t\t\tif (label) content += `<small class=\"${prefix}group-label\">${label}</small>`;\r\n\r\n\t\t\tcontent += this.options(optionElements, name, storedValue, prefix);\r\n\r\n\t\t\tcontent += '</div>';\r\n\t\t});\r\n\r\n\t\treturn content;\r\n\t},\r\n\r\n\toptions(optionElements, name, storedValue, prefix) {\r\n\t\tlet content = '';\r\n\r\n\t\t[].forEach.call(optionElements, option => {\r\n\t\t\tlet value = option.value;\r\n\t\t\tlet label = option.innerHTML;\r\n\t\t\tlet alt = option.getAttribute('alt');\r\n\t\t\tlet classes = option.getAttribute('class');\r\n\t\t\tlet styles = option.getAttribute('style');\r\n\t\t\tlet selected = this.preselected(storedValue, option);\r\n\r\n\t\t\tcontent += `\r\n                    <label \r\n                        class=\"${prefix}item ${classes != null ? classes : ''}\"\r\n                        style=\"${styles != null ? styles : ''}\">\r\n                    <input\r\n                        type=\"radio\"\r\n                        class=\"${prefix}radio\"\r\n                        name=\"${name}\"\r\n                        value=\"${value}\"\r\n                        checked=\"${selected}\">\r\n                        ${label}`;\r\n\r\n\t\t\tif (alt) {\r\n\t\t\t\tcontent += `<small class=\"${prefix}alt\">${alt}</small>`;\r\n\t\t\t}\r\n\r\n\t\t\tcontent += '</label>';\r\n\t\t});\r\n\r\n\t\treturn content;\r\n\t},\r\n\r\n\tpreselected(storedValue, option) {\r\n\t\tif (storedValue === option.value) {\r\n\t\t\treturn true;\r\n\t\t} else if (!storedValue && option.hasAttribute('selected')) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n};\r\n\r\nexport { create };","const update = {\r\n\tlisten(config, optionboxes) {\r\n\t\toptionboxes.forEach(optionbox => {\r\n\t\t\toptionbox.addEventListener('click', e => { // Delegated event listener avoids performance issues of listeneing to every option\r\n\t\t\t\tif (e.target && e.target.tagName === 'INPUT') {\r\n\t\t\t\t\tthis.change(e.target, config);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t},\r\n\r\n\tchange(radio, config) {\r\n\t\tlet prefix = config.prefix;\r\n\t\tlet name = radio.name;\r\n\t\tlet key = config.persist + '>' + name;\r\n\t\tlet value = radio.value;\r\n\t\tlet optionItem = radio.closest('label');\r\n\t\tlet optionbox = radio.closest('.' + prefix);\r\n\r\n\t\tif (optionItem.classList.contains('selected')) {\r\n\t\t\tradio.checked = false;\r\n\t\t\tthis.remove(config, key);\r\n\t\t\tthis.open(optionItem, optionbox);\r\n\t\t} else {\r\n\t\t\tradio.checked = true;\r\n\t\t\tthis.store(config, key, value);\r\n\t\t\tthis.close(optionItem, optionbox);\r\n\t\t}\r\n\t},\r\n\r\n\tclose(optionItem, optionbox) {\r\n\t\tlet optionSiblings = optionbox.querySelectorAll(\r\n\t\t\t'._optionbox-radio:not(:checked)'\r\n\t\t);\r\n\r\n\t\toptionItem.classList.add('selected');\r\n\t\toptionbox.classList.add('closed');\r\n\t\t[].forEach.call(optionSiblings, sibling =>\r\n\t\t\tsibling.closest('label').classList.remove('selected')\r\n\t\t);\r\n\t},\r\n\r\n\topen(optionItem, optionbox) {\r\n\t\toptionItem.classList.remove('selected');\r\n\t\toptionbox.classList.remove('closed');\r\n\t},\r\n\r\n\tinit(optionboxes) {\r\n\t\toptionboxes.forEach(optionbox => {\r\n\t\t\tlet preselects = optionbox.querySelectorAll('[checked=true]');\r\n\r\n\t\t\t[].forEach.call(preselects, preselect => {\r\n\t\t\t\tpreselect.click();\r\n\t\t\t});\r\n\t\t});\r\n\t},\r\n\r\n\tstore(config, key, value) {\r\n\t\tif (config.persist) {\r\n\t\t\tsessionStorage[key] = value;\r\n\t\t}\r\n\t},\r\n\r\n\tremove(config, key) {\r\n\t\tif (config.persist) {\r\n\t\t\tdelete sessionStorage[key];\r\n\t\t}\r\n\t}\r\n};\r\n\r\nexport { update };\r\n","import { get } from './_get';\nimport { create } from './_create';\nimport { update } from './_update';\n\n(<any>window).optionbox = (userConfig) => {\n\tlet config = get.config(userConfig);\n\tlet selectElements = get.selectElements(config.select);\n\n\tlet optionboxes = create.optionboxes(config, selectElements);\n\n\tupdate.listen(config, optionboxes);\n\tupdate.init(optionboxes);\n};\n"],"names":[],"mappings":";;;CAAA,IAAM,GAAG,GAAG;KACX,aAAa,EAAE;SACd,OAAO,EAAE,MAAM,CAAC,QAAQ,CAAC,QAAQ;SACjC,MAAM,EAAE,YAAY;SACpB,MAAM,EAAE,wBAAwB;MAChC;KAED,MAAM,EAAN,UAAO,UAAU;SAChB,IAAI,MAAM,GAAS,MAAO,CAAC,MAAM,CAAC,IAAI,CAAC,aAAa,EAAE,UAAU,CAAC,CAAC;SAElE,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE,EAAE;aAC1B,MAAM,CAAC,OAAO,GAAG,KAAK,CAAC;UACvB;SAED,OAAO,MAAM,CAAC;MACd;KAED,aAAa;SACZ,IAAI,OAAO,OAAO,KAAK,SAAS,EAAE;aACjC,OAAO,IAAI,CAAC;UACZ;SAED,OAAO,KAAK,CAAC;MACb;KAED,cAAc,YAAC,QAAQ;SACtB,IAAI,QAAQ,GAAG,QAAQ,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;SACnD,IAAI,OAAO,GAAG,EAAE,CAAC;SAEjB,IAAI,QAAQ,CAAC,MAAM,EAAE;aACpB,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,QAAQ,EAAE,UAAA,OAAO;iBAChC,IAAI,OAAO,CAAC,OAAO,KAAK,QAAQ,EAAE;qBACjC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;kBACtB;;qBACA,OAAO,CAAC,IAAI,CACX,gDAAgD;yBAChD,OAAO,CAAC,OAAO,CAAC,WAAW,EAAE;yBAC7B,4DAA4D,CAC5D,CAAC;cACH,CAAC,CAAC;UACH;SAED,OAAO,OAAO,CAAC;MACf;EACD,CAAC;;CC5CF,IAAM,MAAM,GAAG;KACd,WAAW,YAAC,MAAM,EAAE,cAAc;SAAlC,iBA2CC;SA1CA,IAAI,iBAAiB,GAAG,EAAE,CAAC;SAE3B,cAAc,CAAC,OAAO,CAAC,UAAA,MAAM;aAC5B,IAAI,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC;aAC3B,IAAI,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC;aACvB,IAAI,OAAO,GAAG,MAAM,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;aAC3C,IAAI,MAAM,GAAG,MAAM,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;aAC1C,IAAI,WAAW,GAAG,EAAE,CAAC;aACrB,IAAI,gBAAgB,GAAG,MAAM,CAAC,gBAAgB,CAAC,UAAU,CAAC,CAAC;aAC3D,IAAI,cAAc,GAAG,MAAM,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;aACvD,IAAI,SAAS,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;aAC/C,IAAI,OAAO,GAAG,gBAAc,MAAM,eAAY,CAAC;aAE/C,IAAI,MAAM,CAAC,OAAO,EAAE;iBACnB,WAAW,GAAG,cAAc,CAAC,MAAM,CAAC,OAAO,GAAG,GAAG,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC;cACjE;aAED,SAAS,CAAC,EAAE,GAAG,MAAM,GAAG,IAAI,CAAC;aAC7B,OAAO,IAAI,IAAI,IAAI,SAAS,CAAC,YAAY,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;aAC5D,SAAS,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;aAChC,MAAM,IAAI,IAAI,IAAI,SAAS,CAAC,YAAY,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;aAG1D,IAAI,gBAAgB,CAAC,MAAM,EAAE;iBAC5B,OAAO,IAAI,KAAI,CAAC,SAAS,CAAC,gBAAgB,EAAE,IAAI,EAAE,WAAW,EAAE,MAAM,CAAC,CAAC;cACvE;kBAAM;iBACN,OAAO,IAAI,KAAI,CAAC,OAAO,CAAC,cAAc,EAAE,IAAI,EAAE,WAAW,EAAE,MAAM,CAAC,CAAC;cACnE;aAED,OAAO,IAAI,QAAQ,CAAC;aAEpB,SAAS,CAAC,SAAS,GAAG,OAAO,CAAC;aAE9B,MAAM,CAAC,qBAAqB,CAAC,aAAa,EAAE,SAAS,CAAC,CAAC;aAEvD,MAAM,CAAC,aAAa,GAAG,CAAC,CAAC,CAAC;aAC1B,MAAM,CAAC,MAAM,EAAE,CAAC;aAEhB,iBAAiB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;UAClC,CAAC,CAAC;SAEH,QAAQ,iBAAiB,EAAE;MAC3B;KAED,SAAS,YAAC,gBAAgB,EAAE,IAAI,EAAE,WAAW,EAAE,MAAM;SAArD,iBAqBC;SApBA,IAAI,OAAO,GAAG,EAAE,CAAC;SAEjB,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,gBAAgB,EAAE,UAAA,QAAQ;aACzC,IAAI,KAAK,GAAG,QAAQ,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;aAC3C,IAAI,OAAO,GAAG,QAAQ,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;aAC7C,IAAI,MAAM,GAAG,QAAQ,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;aAC5C,IAAI,cAAc,GAAG,QAAQ,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;aAEzD,OAAO,IAAI,oCACW,MAAM,eAAS,OAAO,IAAI,IAAI,GAAG,OAAO,GAAG,EAAE,sCAC7C,MAAM,IAAI,IAAI,GAAG,MAAM,GAAG,EAAE,SAAI,CAAC;aAEvD,IAAI,KAAK;iBAAE,OAAO,IAAI,oBAAiB,MAAM,sBAAgB,KAAK,aAAU,CAAC;aAE7E,OAAO,IAAI,KAAI,CAAC,OAAO,CAAC,cAAc,EAAE,IAAI,EAAE,WAAW,EAAE,MAAM,CAAC,CAAC;aAEnE,OAAO,IAAI,QAAQ,CAAC;UACpB,CAAC,CAAC;SAEH,OAAO,OAAO,CAAC;MACf;KAED,OAAO,YAAC,cAAc,EAAE,IAAI,EAAE,WAAW,EAAE,MAAM;SAAjD,iBA+BC;SA9BA,IAAI,OAAO,GAAG,EAAE,CAAC;SAEjB,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,cAAc,EAAE,UAAA,MAAM;aACrC,IAAI,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC;aACzB,IAAI,KAAK,GAAG,MAAM,CAAC,SAAS,CAAC;aAC7B,IAAI,GAAG,GAAG,MAAM,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;aACrC,IAAI,OAAO,GAAG,MAAM,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;aAC3C,IAAI,MAAM,GAAG,MAAM,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;aAC1C,IAAI,QAAQ,GAAG,KAAI,CAAC,WAAW,CAAC,WAAW,EAAE,MAAM,CAAC,CAAC;aAErD,OAAO,IAAI,oEAEmB,MAAM,cAAQ,OAAO,IAAI,IAAI,GAAG,OAAO,GAAG,EAAE,8CAC5C,MAAM,IAAI,IAAI,GAAG,MAAM,GAAG,EAAE,kHAG5B,MAAM,gDACP,IAAI,4CACH,KAAK,8CACH,QAAQ,qCACjB,KAAO,CAAC;aAE/B,IAAI,GAAG,EAAE;iBACR,OAAO,IAAI,oBAAiB,MAAM,cAAQ,GAAG,aAAU,CAAC;cACxD;aAED,OAAO,IAAI,UAAU,CAAC;UACtB,CAAC,CAAC;SAEH,OAAO,OAAO,CAAC;MACf;KAED,WAAW,YAAC,WAAW,EAAE,MAAM;SAC9B,IAAI,WAAW,KAAK,MAAM,CAAC,KAAK,EAAE;aACjC,OAAO,IAAI,CAAC;UACZ;cAAM,IAAI,CAAC,WAAW,IAAI,MAAM,CAAC,YAAY,CAAC,UAAU,CAAC,EAAE;aAC3D,OAAO,IAAI,CAAC;UACZ;SAED,OAAO,KAAK,CAAC;MACb;EACD,CAAC;;CC/GF,IAAM,MAAM,GAAG;KACd,MAAM,YAAC,MAAM,EAAE,WAAW;SAA1B,iBAQC;SAPA,WAAW,CAAC,OAAO,CAAC,UAAA,SAAS;aAC5B,SAAS,CAAC,gBAAgB,CAAC,OAAO,EAAE,UAAA,CAAC;iBACpC,IAAI,CAAC,CAAC,MAAM,IAAI,CAAC,CAAC,MAAM,CAAC,OAAO,KAAK,OAAO,EAAE;qBAC7C,KAAI,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;kBAC9B;cACD,CAAC,CAAC;UACH,CAAC,CAAC;MACH;KAED,MAAM,YAAC,KAAK,EAAE,MAAM;SACnB,IAAI,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC;SAC3B,IAAI,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC;SACtB,IAAI,GAAG,GAAG,MAAM,CAAC,OAAO,GAAG,GAAG,GAAG,IAAI,CAAC;SACtC,IAAI,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC;SACxB,IAAI,UAAU,GAAG,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;SACxC,IAAI,SAAS,GAAG,KAAK,CAAC,OAAO,CAAC,GAAG,GAAG,MAAM,CAAC,CAAC;SAE5C,IAAI,UAAU,CAAC,SAAS,CAAC,QAAQ,CAAC,UAAU,CAAC,EAAE;aAC9C,KAAK,CAAC,OAAO,GAAG,KAAK,CAAC;aACtB,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;aACzB,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE,SAAS,CAAC,CAAC;UACjC;cAAM;aACN,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC;aACrB,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE,GAAG,EAAE,KAAK,CAAC,CAAC;aAC/B,IAAI,CAAC,KAAK,CAAC,UAAU,EAAE,SAAS,CAAC,CAAC;UAClC;MACD;KAED,KAAK,YAAC,UAAU,EAAE,SAAS;SAC1B,IAAI,cAAc,GAAG,SAAS,CAAC,gBAAgB,CAC9C,iCAAiC,CACjC,CAAC;SAEF,UAAU,CAAC,SAAS,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;SACrC,SAAS,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;SAClC,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,cAAc,EAAE,UAAA,OAAO;aACtC,OAAA,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC,UAAU,CAAC;UAAA,CACrD,CAAC;MACF;KAED,IAAI,YAAC,UAAU,EAAE,SAAS;SACzB,UAAU,CAAC,SAAS,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;SACxC,SAAS,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;MACrC;KAED,IAAI,YAAC,WAAW;SACf,WAAW,CAAC,OAAO,CAAC,UAAA,SAAS;aAC5B,IAAI,UAAU,GAAG,SAAS,CAAC,gBAAgB,CAAC,gBAAgB,CAAC,CAAC;aAE9D,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,EAAE,UAAA,SAAS;iBACpC,SAAS,CAAC,KAAK,EAAE,CAAC;cAClB,CAAC,CAAC;UACH,CAAC,CAAC;MACH;KAED,KAAK,YAAC,MAAM,EAAE,GAAG,EAAE,KAAK;SACvB,IAAI,MAAM,CAAC,OAAO,EAAE;aACnB,cAAc,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;UAC5B;MACD;KAED,MAAM,YAAC,MAAM,EAAE,GAAG;SACjB,IAAI,MAAM,CAAC,OAAO,EAAE;aACnB,OAAO,cAAc,CAAC,GAAG,CAAC,CAAC;UAC3B;MACD;EACD,CAAC;;CChEI,MAAO,CAAC,SAAS,GAAG,UAAC,UAAU;KACpC,IAAI,MAAM,GAAG,GAAG,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;KACpC,IAAI,cAAc,GAAG,GAAG,CAAC,cAAc,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;KAEvD,IAAI,WAAW,GAAG,MAAM,CAAC,WAAW,CAAC,MAAM,EAAE,cAAc,CAAC,CAAC;KAE7D,MAAM,CAAC,MAAM,CAAC,MAAM,EAAE,WAAW,CAAC,CAAC;KACnC,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;CAC1B,CAAC,CAAC;;;;"}