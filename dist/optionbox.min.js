(function () {
  'use strict';

  var core = {
    init: function init(selector) {
      var elements = selector ? document.querySelectorAll(selector) : document.querySelectorAll("select");
      var selects = [];
      if (elements.length) {
        [].forEach.call(elements, function (element) {
          if (element.tagName == "SELECT") {
            selects.push(element);
          } else console.warn("Optionbox warning: Your selection includes a <" + element.tagName.toLowerCase() + ">. Only <select> elements can be converted to an optionbox");
        });
        this.create(selects);
        this.listen(document.querySelectorAll(".optionbox-radio"));
      }
    },
    create: function create(selects) {
      var _this = this;

      selects.forEach(function (select) {
        var optionsBox = document.createElement("span");

        optionsBox.classList.add("optionbox");
        optionsBox.innerHTML = _this.replicate(select.querySelectorAll("option"), select.name);

        select.insertAdjacentElement("beforebegin", optionsBox);

        select.selectedIndex = -1;
        select.hidden = true;
      });
    },
    replicate: function replicate(options, name) {
      var content = "";

      [].forEach.call(options, function (option) {
        content += "\n        <label class=\"optionbox-item\">\n          <input\n            type=\"radio\"\n            class=\"optionbox-radio\"\n            name=\"" + name + "-options\"\n            data-optionbox-name=\"" + name + "\"\n            data-optionbox-value=\"" + option.value + "\">\n          " + option.innerHTML + "\n        </label>";
      });

      return content;
    },
    listen: function listen(radios) {
      var _this2 = this;

      [].forEach.call(radios, function (radio) {
        radio.onclick = function () {
          var name = radio.dataset.optionboxName;
          var value = radio.dataset.optionboxValue;
          _this2.select(radio, name, value);
        };
      });
    },
    select: function select(radio, name, value) {
      var select = document.querySelector("[name=" + name + "]");
      var optionItem = radio.closest(".optionbox-item");
      var optionsBox = radio.closest(".optionbox");
      var optionSiblings = optionsBox.querySelectorAll(".optionbox-radio:not(:checked)");

      if (select.value != value) {
        // select if not previously selected
        select.value = value;
        optionItem.classList.add("selected");
        optionsBox.classList.add("closed");
        [].forEach.call(optionSiblings, function (sibling) {
          return sibling.closest("label").classList.remove("selected");
        });
      } else {
        // deselect if previously selected
        select.selectedIndex = -1;
        radio.checked = false;
        optionItem.classList.remove("selected");
        optionsBox.classList.remove("closed");
      }
    }
  };

  core.init();

}());
//# sourceMappingURL=optionbox.min.js.map
